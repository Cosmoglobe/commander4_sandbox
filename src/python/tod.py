# Read parameter file

# Initialize TOD data structures

# Initialize signal model

# Run Gibbs chain
for i = 1, numsamp:
    # Update signal model from partner process

    # Estimate white noise level by signal-subtracted TOD

    # Generate frequency map

    # Store frequency map in chain file

    # Send frequency map to partner process

