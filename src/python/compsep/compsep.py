# Read parameter file

# Initialize frequency map data structures

# Initialize signal model

# Run Gibbs chain
for i = 1, numsamp:
    # Update frequency map from partner process

    # Generate RHS of CG equation

    # Solve compsep equation by CG

    # Store a_lms in chain file

    for j = 1, numband:
        # Generate sky model

        # Send sky model to partner process

